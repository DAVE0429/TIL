### JPA에서의 양방향 연관관계와 연관관계의 주인
- 테이블 상태에서의 연관관계는 문제가 발생하지 않는다. 
- 상대의 기본키를 외래키로 가지고 있는 테이블 끼리 서로 조인하여 값을 가져오면 되기 떄문이다.
- 하지만 문제는 객체로 변환했을때 발생한다.
- @OneToMany와 @ManyToOne을 각각 적용하고 mappedBy를 사용해서 어떤것과 매핑이 되어있는지 작성한다.
- 객체와 테이블간에 연관관계를 맺는 차이를 이해해야 한다.
- 회원과 팀이라는 테이블이 있다고 생각한다면 
  - 객체 연관관계는 2개
    회원 -> 팀 단방향
    팀 -> 회원 단방향
  - 테이블 연관관계는 1개
    회원 <-> 팀 양방향이지만 사실 방향은 없음
- 객체의 양방향 관계는 사실 양방향이 아니라 서로 다른 단방향 관계가 2개다.
- 둘 중 하나로 외래 키를 관리해야 한다.

- 테이블의 양방향 연관관계
  - 테이블은 외래 키 하나로 두 테이블이 연관관계를 관리
  - 외래 키 하나로 양방향 연관관계 가짐(양쪽으로 조인할 수 있다.)

### 연관관계의 주인(Owner)
#### 양방향 매핑 규칙
  - 객체의 두 관계중 하나를 연관관계의 주인으로 지정
  - 연관관계의 주인만이 외래 키를 관리(등록, 수정)
  - 주인이 아닌쪽은 읽기만 가능
  - 주인은 mappedBy 속성 사용X
  - 주인이 아니면 mappedBy 속성으로 주인을 지정한다.
  - 외래 키가 있는 곳을 주인으로 정해라

### 양방향 매핑시 가장 많이 하는 실수
- 연관관계의 주인에 값을 입력하지 않음
- 양방향 매핑시 연관관계의 주인에 값을 입력해야한다.(순수한 객체 관계를 고려하면 항상 양쪽다 값을 입력해야한다.)
- 순수 객체 상태를 고려해서 항상 양쪽에 값을 설정하자
- 연관관계 편의 메소드를 생성하자
- 양방향 매핑시에 무한 루프를 조심하자
- Entity를 절대 컨트롤러에서 반환하지 말자(변경이 될 수 있는데 그렇게 되면 사용하던 API 스펙이 완전히 바뀌기 때문)

### 양방향 매핑 정리
- 단방향 매핑만으로도 이미 연관관계 매핑은 완료
- 양방향 매핑은 반대 방향으로 조회(객체 그래프 탐색) 기능이 추가된 것 뿐
- JPQL에서 역방향으로 탐색할 일이 많음
- 단방향 매핑을 잘 하고 양방향은 필요할 때 추가해도 됨(테이블에 영향을 주지 않음)
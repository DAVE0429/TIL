### 엔티티 설계 시 주의할 점
- setter를 가급적 사용하지 않고 필요한 경우 따로 정의해서 사용하는 것이 좋다. (변경 포인트가 너무 많아서 유지보수가 어려워진다.)
- 엔티티의 식별자는 id를 사용하고 PK칼럼명은 스네이크 케이스를 사용하는 것이 좋다.
- 엔티티는 타입이 있으므로 id 필드만으로 쉽게 구분할 수있다.
- 테이블은 타입이 없으므로 구분이 어렵다. 그리고 테이블은 관례상 테이블명 + id를 많이 사용한다.
- 참고로 객체에서 id 대신에 클래스명 + 카멜 케이스를 사용해도 좋지만 일관성있게 작성하는 것이 중요하다.

- 실무에서는 ManyToMany(다대다)를 사용하지 말자
- 편리한 것 같지만, 중간 테이블에 컬럼을 추가할 수 없고, 세밀하게 쿼리를 실행하기 어렵기 떄문에 시룸에서 사용하기에는 한계가 있다.
- 중간 엔티티를 만들고 ManyToOne, OneToMany로 매핑해서 사용하자. 정리하면 다대다를 일대다, 다대일로 풀어서 사용하자

- 값 타입은 변경 불가능하게 설계해야 한다.
- Setter를 제거하고 생성자에서 값을 모두 초기화해서 변경이 불가능한 클래스로 만들어야 한다.
- 임베디드 타입(@Embeddable)은 자바 기본 생성자(default constructor)를 public 또는 protected로 설정해야 한다,
- public 으로 두는 것 보다는 protected로 설정하는 것이 그나마 더 안전하다.
- JPA가 이런 제약을 두는 이유는 JPA 구현 라이브러리가 객체를 생성할 때 리플렉션 같은 기술을 사용할 수 있도록 지원해야 하기 떄문이다.

#### 모든 연관관계는 지연로딩으로 설정
- 즉시 로딩(EAGER)은 예측이 어렵고, 어떤 SQL이 실행될지 추적하기 어렵다.
- 특히 JPQL을 실행할 때 N+1 문제가 자주 발생한다. 
- 실무에서 모든 연관관계는 지연로딩(LAZY)으로 설정해야 한다.
- 연관된 엔티티를 함께 DB에서 조회해야 하면, fetch join 또는 엔티티 그래프 기능을 사용한다.
- @XToOne(OneToOne, ManyToOne) 관계는 기본이 즉시로딩(EAGER)이므로 직접 지연로딩으로 설정해야 한다.

#### 컬렉션은 필드에서 초기화 하자
- 컬렉션은 필드에서 바로 초기화 하는 것이 안전하다.
- null 문제에서 안전하다.
- 하이버네이트는 엔티티를 영속화 할 때, 컬렉션을 감싸서 하이버네이트가 제공하는 내장 컬렉션으로 변경한다.
- 만약 getOrders() 처럼 임의의 메서드에서 컬렉션을 잘못 생성하면 하이버네이트 내부 매커니즘에 문제가 발생할 수 있다.
- 따라서 필드레벨에서 생성하는 것이 가장 안전하고, 코드도 안전하다.

#### 테이블, 컬럼명 생성 전략
- 하이버네이트 기존 구현: 엔티티의 필드명을 그대로 테이블의 컬럼명으로 사용(SpringPhysicalNamingStrategy)
- 스프링 부트 신규 설정(엔티티(필드) -> 테이블(컬럼))
1. 카멜 케이스 -> 언더 스코어(memberPoint -> member_point)
2. .(점) -> _(언더 스코어)
3. 대문자 -> 소문자

- 적용 2 단계 
1. 논리명 생성: 명시적으로 컬럼, 테이블명을 직접 적지 않으면 ImplicitNamingStrategy 사용
`spring.jpa.hibernate.naming.implicit-strategy` : 테이블이나, 컬럼명을 명시하지 않을 때 논리명 적
용,

2. 물리명 적용:
`spring.jpa.hibernate.naming.physical-strategy` : 모든 논리명에 적용됨, 실제 테이블에 적용
(username usernm 등으로 회사 룰로 바꿀 수 있음)

** 스프링 부트 기본 설정 **
`spring.jpa.hibernate.naming.implicit-strategy:
org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy`
`spring.jpa.hibernate.naming.physical-strategy:
org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy`